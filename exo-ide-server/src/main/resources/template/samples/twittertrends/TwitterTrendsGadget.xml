<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="Twitter trend as images" scrolling="true">
  <Require feature="dynamic-height"/>
</ModulePrefs>
<Content type="html">
<![CDATA[ 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <style>
    body {
      background-color: #F4F4F4;
    }  
    
    .trend {
      background: #F8F8F8;
      border: 1px solid #EEE;
      border-bottom: 1px solid #DDD;
      margin: 20px;
      padding: 5px;
      -moz-border-radius: 6px;
      -webkit-border-radius: 6px;
      border-radius: 6px;
    }
    
    .name {
      font-weight: bold;
      color: #333;
      font-size: 13px;
      font-family: 'Helvetica Neue', Helvetica-Neue, Helvetica, 'MgOpen Moderna', sans-serif;
      text-decoration: none;
    }
    img {
      width: 75px;
      height: 75px;
    }
  </style>
  
  <script>
    function loadTrends() {
      var params = {};  
      params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
      var url = "http://www.cloud-ide.com/rest/twitter_trends/images?length=4&t=" + new Date().getTime(); //Change here to your tenant
      gadgets.io.makeRequest(url, function(response) {
        var data = response.data, html = [];
        $.each(data, function(index, trend) {
          html.push('<div class="trend">');
          
          html.push('<div><a href="http://twitter.com/search/', encodeURIComponent(trend.name), '" class="name" target="_blank">', trend.name, '</a></div>');
          if (trend.images.length === 0) {
            html.push('<div class="no-image">Could not find any image on this topic</div>');
          } else {
            $.each(trend.images, function(index, image) {
              html.push('<a href="', image.replace("_m.jpg", ".jpg"), '" target="_blank"><img src="', image.replace("_m.jpg", "_s.jpg"), '" /></a>');
            });
          }
          
          html.push("</div>");
        })
        $("#content").html(html.join(""));
        gadgets.window.adjustHeight();
      }, params);
    }
    gadgets.util.registerOnLoadHandler(loadTrends);
  </script>
  <div id="content">Loading</div>
]]>
 </Content></Module>