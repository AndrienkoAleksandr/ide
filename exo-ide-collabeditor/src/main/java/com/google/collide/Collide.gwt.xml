<module>
  <entry-point class="com.google.collide.client.Collide" />

  <source path="client"/>
  <source path="shared"/>
  <source path="json"/>
  <source path="mvp"/>
  <source path="dto"/>
  <source path="codemirror2"/>
  <source path="dotgen"/>
  <source path="dtogen"/>

  <inherits name="com.google.gwt.user.User"/>

  <inherits name="elemental.Elemental" />
  <inherits name='org.exoplatform.ide.editor.API' />

  <inherits name="com.google.common.base.Base" />
  <inherits name="com.google.common.collect.Collect" />
  <inherits name="com.google.common.annotations.Annotations" />

  <inherits name="org.waveprotocol.wave.model.Model"/>
  <inherits name="org.waveprotocol.wave.client.common.util.Util"/>

  <!-- This provides deferred binding for the client windowing system.
       This can be used to make labels for "native" accelerators, etc. -->
  <define-property name="webide.clientOs" values="macintosh,windows,x11,other"/> 
  <property-provider name="webide.clientOs"><![CDATA[
    var ua = navigator.userAgent.toLowerCase();
    if (ua.indexOf("(macintosh;") != -1) {
      return "macintosh";
    } else if (ua.indexOf("(windows;") != -1) {
      return "windows";
    } else if (ua.indexOf("(x11;") != -1) {
      return "x11";
    } else {
      return "other";
    }
  ]]></property-provider>

  <!-- replace-with rules for client environment. -->
  <replace-with class="com.google.collide.client.ClientOsOther">
    <when-type-is class="com.google.collide.client.ClientOs" />
  </replace-with>
  <replace-with class="com.google.collide.client.ClientOsMacintosh">
    <when-type-is class="com.google.collide.client.ClientOs" />
    <when-property-is name="webide.clientOs" value="macintosh" />
  </replace-with>


  <!--
    Release Mode is either "debug" or "release", and will be so by a
    set-property rather than by a property provider.
  -->
  <define-property name="webide.release_mode" values="debug, release"/>
  <property-provider name="webide.release_mode"><![CDATA[
    if (location.search.match(/[?&]debug([=&].*)?$/)) {
      return "debug";
    } else {
      return "release";
    }
  ]]></property-provider>

  <!-- This provides deferred binding for the debugging API implementation. -->
  <set-configuration-property name='CssResource.style' value='stable' />

 <replace-with
     class="com.google.collide.client.util.BrowserUtils.Chrome">
    <when-type-is
       class="com.google.collide.client.util.BrowserUtils"/>
    <when-property-is name="user.agent" value="safari"/>
  </replace-with>
  <replace-with
     class="com.google.collide.client.util.BrowserUtils.Firefox">
    <when-type-is
       class="com.google.collide.client.util.BrowserUtils"/>
    <when-property-is name="user.agent" value="gecko1_8"/>
  </replace-with>

  <replace-with
     class="com.google.collide.client.ClientConfig.DebugMode">
    <when-type-is
       class="com.google.collide.client.ClientConfig.DebugOrReleaseMode"/>
    <when-property-is name="webide.release_mode" value="debug"/>
  </replace-with>
  <replace-with
     class="com.google.collide.client.util.logging.LogConfig.Enabled">
    <when-type-is
       class="com.google.collide.client.util.logging.LogConfig"/>
  </replace-with>

  <replace-with
     class="com.google.collide.client.ClientConfig.ReleaseMode">
    <when-type-is
       class="com.google.collide.client.ClientConfig.DebugOrReleaseMode"/>
    <when-property-is name="webide.release_mode" value="release"/>
  </replace-with>
</module>
