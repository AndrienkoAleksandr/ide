<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

	<parent>
		<groupId>org.exoplatform.ideall</groupId>
		<artifactId>ideall.parent</artifactId>
		<version>1.0-Beta03-SNAPSHOT</version>
	</parent>

	<modelVersion>4.0.0</modelVersion>
	<groupId>org.exoplatform.ideall</groupId>
	<artifactId>exo.ideall.client</artifactId>
	<packaging>war</packaging>
	<name>eXo IDE :: Client</name>

	<dependencies>
		<dependency>
			<groupId>org.exoplatform.gwt</groupId>
			<artifactId>exo.gwtframework.commons</artifactId>
		</dependency>
		<dependency>
			<groupId>org.exoplatform.gwt</groupId>
			<artifactId>exo.gwtframework.editor</artifactId>
		</dependency>
		<dependency>
			<groupId>org.exoplatform.gwt</groupId>
			<artifactId>exo.gwtframework.ui</artifactId>
		</dependency>
		<dependency>
			<groupId>com.google.gwt</groupId>
			<artifactId>gwt-servlet</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>com.google.gwt</groupId>
			<artifactId>gwt-user</artifactId>
			<scope>provided</scope>
		</dependency>
		
	<dependency>
			<groupId>com.google.gwt</groupId>
	       <artifactId>gwt-dev</artifactId>
			<scope>provided</scope>
		</dependency>		
		
		<dependency>
			<groupId>com.smartgwt</groupId>
			<artifactId>smartgwt</artifactId>
		</dependency>
		
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<scope>test</scope>
		</dependency>


		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
			<artifactId>exo-ideall-client-module-vfs</artifactId>
			<version>${project.version}</version>
		</dependency>
		<!--
		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
			<artifactId>exo.ideall.client.groovy</artifactId>
			<version>${project.version}</version>
		</dependency>
-->
		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
			<artifactId>exo-ideall-client-framework</artifactId>
			<version>${project.version}</version>
		</dependency>
		
		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
			<artifactId>exo-ideall-client-module-gadget</artifactId>
			<version>${project.version}</version>
		</dependency>

		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
			<artifactId>exo-ideall-client-module-groovy</artifactId>
			<version>${project.version}</version>
		</dependency>
		<dependency>
			<groupId>org.exoplatform.ideall</groupId>
	 		<artifactId>exo-ideall-client-module-netvibes</artifactId>
	 		<version>${project.version}</version>
		</dependency>
	</dependencies>
	<build>
		<finalName>IDEall</finalName>
		<sourceDirectory>src/main/java</sourceDirectory>
		<outputDirectory>target/war/WEB-INF/classes</outputDirectory>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-surefire-plugin</artifactId>
				<configuration>
					<skipTests>true</skipTests>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>buildnumber-maven-plugin</artifactId>
				<executions>
					<execution>
						<phase>validate</phase>
						<goals>
							<goal>create</goal>
						</goals>
					</execution>
				</executions>
				<configuration>
					<timestampFormat>{0, date, yyyy-MM-dd HH:mm:ss}</timestampFormat>
					<doCheck>false</doCheck>
					<doUpdate>false</doUpdate>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-antrun-plugin</artifactId>
				<executions>
					<execution>
						<id>buildnumber</id>
						<goals>
							<goal>run</goal>
						</goals>
						<phase>initialize</phase>
						<configuration>
							<tasks>
								<delete file="src/main/resources/org/exoplatform/ideall/client/BuildNumber.properties" />
								<echo file="src/main/resources/org/exoplatform/ideall/client/BuildNumber.properties" append="false">
									buildNumber: ${buildNumber}
									buildTime: ${timestamp}
									version: ${project.version}
                </echo>
							</tasks>
						</configuration>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>

	<profiles>
		<profile>
			<id>standalone</id>
			<activation>
				<activeByDefault>false</activeByDefault>
			</activation>
			<build>
				<plugins>
					<!--  configure the GWT-Maven plugin -->
					<plugin>
						<groupId>org.codehaus.mojo</groupId>
						<artifactId>gwt-maven-plugin</artifactId>
						<configuration>
							<module>org.exoplatform.ideall.IDEApplication</module>
							<runTarget>org.exoplatform.ideall.IDEApplication/IDEApplication.html</runTarget>
							<logLevel>INFO</logLevel>
							<hostedWebapp>${basedir}/target/war</hostedWebapp>
							<tomcat>${basedir}/target/tomcat</tomcat>
							<skipTests>${gwt.test.skip}</skipTests>
						</configuration>
						<executions>
							<execution>
								<goals>
									<goal>compile</goal>
									<goal>test</goal>
								</goals>
							</execution>
						</executions>
					</plugin>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-war-plugin</artifactId>
						<configuration>
							<webXml>src/main/webapp/application/web.xml</webXml>
							<warSourceExcludes>.gwt-tmp/**,**/lib/**,**/gadget/**,**/application/**</warSourceExcludes>
							<webResources>
								<resource>
									<directory>src/main/webapp/application</directory>
									<targetPath>WEB-INF</targetPath>
								</resource>
							</webResources>
						</configuration>
					</plugin>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-compiler-plugin</artifactId>
						<configuration>
							<source>${maven.compiler.source}</source>
							<target>${maven.compiler.target}</target>
							<excludes>
								<exclude>**/IDEGadget.java</exclude>
							</excludes>
						</configuration>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>shell</id>
			<activation>
				<activeByDefault>false</activeByDefault>
			</activation>
			<dependencies>
				<dependency>
					<groupId>org.exoplatform.kernel</groupId>
					<artifactId>exo.kernel.commons</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.portal</groupId>
					<artifactId>exo.portal.gadgets-core</artifactId>
				</dependency>

				<dependency>
					<groupId>org.exoplatform.kernel</groupId>
					<artifactId>exo.kernel.container</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.commons</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.rest.core</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.frameworks.servlet</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.rest.ext</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.component.ext</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.component.webdav</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.framework.web</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ideall</groupId>
					<artifactId>exo-ideall-server-component-commons</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ideall</groupId>
					<artifactId>exo-ideall-server-component-netvibes</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.ideall</groupId>
					<artifactId>exo-ideall-server-component-gadget</artifactId>
					<exclusions>
						<exclusion>
							<groupId>pull-parser</groupId>
							<artifactId>pull-parser</artifactId>
						</exclusion>
					</exclusions>
				</dependency>
				<dependency>
					<groupId>hsqldb</groupId>
					<artifactId>hsqldb</artifactId>
				</dependency>
				<dependency>
					<groupId>org.gatein.shindig</groupId>
					<artifactId>shindig-common</artifactId>
				</dependency>
				<dependency>
					<groupId>org.gatein.shindig</groupId>
					<artifactId>shindig-features</artifactId>
				</dependency>
				<dependency>
					<groupId>org.gatein.shindig</groupId>
					<artifactId>shindig-gadgets</artifactId>
				</dependency>
				<dependency>
					<groupId>org.gatein.shindig</groupId>
					<artifactId>shindig-social-api</artifactId>
				</dependency>
				<dependency>
					<groupId>org.slf4j</groupId>
					<artifactId>slf4j-api</artifactId>
				</dependency>
				<dependency>
					<groupId>org.slf4j</groupId>
					<artifactId>slf4j-log4j12</artifactId>
				</dependency>
				<!--
					<dependency> <groupId>log4j</groupId>
					<artifactId>log4j</artifactId> <version>1.2.14</version>
					</dependency>
				-->
				<dependency>
					<groupId>com.google.code.guice</groupId>
					<artifactId>guice</artifactId>
				</dependency>
				<dependency>
					<groupId>com.google.code.guice</groupId>
					<artifactId>guice-jmx</artifactId>
				</dependency>
				<dependency>
					<groupId>javax.xml.bind</groupId>
					<artifactId>jaxb-api</artifactId>
				</dependency>
				<dependency>
					<groupId>com.sun.xml.bind</groupId>
					<artifactId>jaxb-impl</artifactId>
				</dependency>
				<dependency>
					<groupId>caja</groupId>
					<artifactId>caja</artifactId>
					<version>r3375</version>
				</dependency>
				<!-- Chromattic -->
				<dependency>
					<groupId>org.chromattic</groupId>
					<artifactId>chromattic.apt</artifactId>
					<version>${version.chromattic}</version>
					<scope>compile</scope>
				</dependency>
				<dependency>
					<groupId>org.chromattic</groupId>
					<artifactId>chromattic.api</artifactId>
					<version>${version.chromattic}</version>
				</dependency>
				<dependency>
					<groupId>org.chromattic</groupId>
					<artifactId>chromattic.spi</artifactId>
					<version>${version.chromattic}</version>
				</dependency>
				<dependency>
					<groupId>org.chromattic</groupId>
					<artifactId>chromattic.core</artifactId>
					<version>${version.chromattic}</version>
				</dependency>
				<dependency>
					<groupId>org.chromattic</groupId>
					<artifactId>chromattic.ext</artifactId>
					<version>${version.chromattic}</version>
				</dependency>

			</dependencies>
			<build>
				<plugins>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-resources-plugin</artifactId>
						<executions>
							<execution>
								<id>copy-prod-resources</id>
								<phase>process-resources</phase>
								<goals>
									<goal>copy-resources</goal>
								</goals>
								<configuration>
									<outputDirectory>target/war/WEB-INF/</outputDirectory>
									<resources>
										<resource>
											<directory>src/main/webapp/shell</directory>
											<filtering>true</filtering>
										</resource>
									</resources>
								</configuration>
							</execution>
						</executions>
					</plugin>
					<plugin>
						<groupId>org.codehaus.mojo</groupId>
						<artifactId>gwt-maven-plugin</artifactId>
						<configuration>
							<module>org.exoplatform.ideall.IDEApplication</module>
							<runTarget>org.exoplatform.ideall.IDEApplication/IDEApplication.html</runTarget>
							<logLevel>INFO</logLevel>
							<!--
								<logLevel>INFO' -bindAddress 0.0.0.0 -logLevel 'INFO</logLevel>
							-->

							<hostedWebapp>${basedir}/target/war</hostedWebapp>

							<skipTests>${gwt.test.skip}</skipTests>

							<port>${gwt.port}</port>

							<extraJvmArgs>-Xmx512m</extraJvmArgs>

						</configuration>
					</plugin>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-compiler-plugin</artifactId>
						<configuration>
							<source>${maven.compiler.source}</source>
							<target>${maven.compiler.target}</target>
							<excludes>
								<exclude>**/IDEGadget.java</exclude>
							</excludes>
						</configuration>
					</plugin>
				</plugins>
			</build>
		</profile>
		<profile>
			<id>gadget</id>
			<activation>
				<activeByDefault>true</activeByDefault>
			</activation>
			<dependencies>
				<dependency>
					<groupId>com.google.gwt.google-apis</groupId>
					<artifactId>gwt-gadgets</artifactId>
				</dependency>
			</dependencies>
			<build>
				<plugins>
					<!--  configure the GWT-Maven plugin -->
					<plugin>
						<groupId>org.codehaus.mojo</groupId>
						<artifactId>gwt-maven-plugin</artifactId>
						<configuration>
							<module>org.exoplatform.ideall.IDEGadget</module>
							<runTarget>org.exoplatform.ideall.IDEGadget/IDEGadget.html</runTarget>
							<logLevel>INFO</logLevel>
							<hostedWebapp>${basedir}/target/war</hostedWebapp>
							<tomcat>${basedir}/target/tomcat</tomcat>
							<skipTests>false</skipTests>
						</configuration>
						<executions>
							<execution>
								<goals>
									<goal>compile</goal>
								</goals>
							</execution>
						</executions>
					</plugin>
					<!--
						If you want to use the target/web.xml file mergewebxml produces,
						tell the war plugin to use it. Also, exclude what you want from
						the final artifact here.
					-->
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-war-plugin</artifactId>
						<version>2.1-alpha-2</version>
						<configuration>
							<webXml>src/main/webapp/gadget/web.xml</webXml>
							<packagingExcludes>.gwt-tmp/**,**/sc/**,**/lib/**,**/shell/**,**/application/**,**/gadget,**/gadget/gadget.xml,**/gadget/web.xml,,**/classes/**</packagingExcludes>
							<webResources>
								<resource>
									<directory>src/main/webapp/gadget</directory>
									<targetPath>WEB-INF</targetPath>
								</resource>
							</webResources>
						</configuration>
					</plugin>
					<!--  tell the compiler we can use 1.5 -->
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-compiler-plugin</artifactId>
						<configuration>
							<source>${maven.compiler.source}</source>
							<target>${maven.compiler.target}</target>
						</configuration>
					</plugin>
				</plugins>
			</build>
			<properties>
				<maven.test.skip>true</maven.test.skip>
			</properties>
		</profile>

		<profile>
			<id>test</id>
			<activation>
				<activeByDefault>false</activeByDefault>
			</activation>

			<dependencies>
				<!--  test -->
				<dependency>
					<groupId>junit</groupId>
					<artifactId>junit</artifactId>
				</dependency>
				<dependency>
					<groupId>org.exoplatform.kernel</groupId>
					<artifactId>exo.kernel.commons</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.kernel</groupId>
					<artifactId>exo.kernel.container</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.commons</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.rest.core</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.frameworks.servlet</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ws</groupId>
					<artifactId>exo.ws.rest.ext</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.component.ext</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.component.webdav</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.jcr</groupId>
					<artifactId>exo.jcr.framework.web</artifactId>
					<version>${org.exoplatform.jcr.version}</version>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ideall</groupId>
					<artifactId>exo-ideall-server-component-commons</artifactId>

				</dependency>
				<dependency>
					<groupId>org.exoplatform.ideall</groupId>
					<artifactId>exo-ideall-server-component-gadget</artifactId>
					<exclusions>
						<exclusion>
							<groupId>pull-parser</groupId>
							<artifactId>pull-parser</artifactId>

						</exclusion>
					</exclusions>

				</dependency>

				<dependency>
					<groupId>hsqldb</groupId>
					<artifactId>hsqldb</artifactId>

				</dependency>
				<dependency>
					<groupId>org.slf4j</groupId>
					<artifactId>slf4j-api</artifactId>

				</dependency>
				<dependency>
					<groupId>org.slf4j</groupId>
					<artifactId>slf4j-log4j12</artifactId>

				</dependency>

				<!--
					<dependency> <groupId>log4j</groupId>
					<artifactId>log4j</artifactId> </dependency>
				-->
				<dependency>
					<groupId>com.google.code.guice</groupId>
					<artifactId>guice</artifactId>

				</dependency>
				<dependency>
					<groupId>com.google.code.guice</groupId>
					<artifactId>guice-jmx</artifactId>

				</dependency>
				<dependency>
					<groupId>javax.xml.bind</groupId>
					<artifactId>jaxb-api</artifactId>

				</dependency>
				<dependency>
					<groupId>com.sun.xml.bind</groupId>
					<artifactId>jaxb-impl</artifactId>

				</dependency>
			</dependencies>
			<build>
				<resources>
					<resource>
						<directory>src/test/resources</directory>
					</resource>
					<resource>
						<directory>src/test/java</directory>
					</resource>
				</resources>
				<plugins>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-antrun-plugin</artifactId>
						<executions>
							<execution>
								<id>copy-tomcat-resources-buid-IDEall.war</id>
								<goals>
									<goal>run</goal>
								</goals>
								<phase>test-compile</phase>
								<configuration>
									<tasks>
										<echo>copy tomcat resources</echo>
										<copy todir="${basedir}/tomcat/">
											<fileset dir="${basedir}/src/test/resources/tomcat-res" />
										</copy>
										<echo>build ideall.war</echo>
										<war destfile="${basedir}/tomcat/webapps/ideall.war" basedir="${basedir}/src/test/webapp" needxmlfile="false" />
									</tasks>
								</configuration>
							</execution>
						</executions>
					</plugin>

					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-surefire-plugin</artifactId>
						<configuration>
							<excludes>
								<exclude>**/GwtTest*.java</exclude>
								<exclude>**/*Gwt*Suite*.java</exclude>
							</excludes>
						</configuration>
					</plugin>



					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-war-plugin</artifactId>
						<configuration>
							<webXml>src/test/webapp/WEB-INF/web.xml</webXml>
							<warSourceExcludes>.gwt-tmp/**,**/lib/**,**/gadget/**,**/application/**</warSourceExcludes>
							<webResources>
								<resource>
									<directory>src/test/webapp/WEB-INF</directory>
									<targetPath>WEB-INF</targetPath>
								</resource>
							</webResources>
						</configuration>
					</plugin>
					<plugin>
						<groupId>org.codehaus.mojo</groupId>
						<artifactId>gwt-maven-plugin</artifactId>
						<version>1.3-SNAPSHOT</version>
						<configuration>
							<module>org.exoplatform.ideall.IDEGwtTest</module>
							<runTarget>org.exoplatform.ideall.IDEGwtTest/IDEGwtTest.html</runTarget>
							<logLevel>INFO</logLevel>
							<hostedWebapp>${basedir}/target/war</hostedWebapp>
							<!--tomcat>${basedir}/target/tomcat</tomcat-->
							<tomcat>${basedir}/tomcat</tomcat>
							<skipTests>false</skipTests>
							<webXml>${basedir}/src/test/webapp/WEB-INF/web.xml</webXml>
						</configuration>
						<executions>
							<execution>
								<goals>
									<!--goal>compile</goal-->
									<goal>test</goal>
								</goals>
							</execution>
						</executions>
					</plugin>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-compiler-plugin</artifactId>
						<configuration>
							<source>${maven.compiler.source}</source>
							<target>${maven.compiler.target}</target>
							<excludes>
								<exclude>**/IDEGadget.java</exclude>
							</excludes>
						</configuration>
					</plugin>
				</plugins>
			</build>
		</profile>
	</profiles>
</project>
